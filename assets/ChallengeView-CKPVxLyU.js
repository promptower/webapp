import{_ as F,u as R,a as z,b as E,r as h,o as b,c as M,d as t,t as f,w as C,v as S,e as Z,B as Q,J as K,f as A,C as I,Z as L,g as X,n as v,k as P,h as j,p as Y,i as tt,F as q,j as et,l as N,m as V,q as st}from"./index-Bhhjmu63.js";import{G as at,a as nt,U as it,B as ot,g as lt}from"./gameView-DCFB2x26.js";BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");BigInt("1000000000000000000");const rt=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");BigInt("0x8000000000000000000000000000000000000000000000000000000000000000")*BigInt(-1);BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");async function dt(o,l,r,n){const p="https://ib9fm6yjjg.execute-api.ap-northeast-2.amazonaws.com/ctp/ctp/create-prompt",w={prompt_hash:o,prompt:l,secret_hash:r,secret:n};try{const g=await(await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();console.log(g.message)}catch(m){console.error("Error:",m)}}const ct="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='11'%20height='18'%20viewBox='0%200%2011%2018'%20fill='none'%3e%3crect%20x='8.59265'%20y='0.928223'%20width='2.69743'%20height='11.4442'%20transform='rotate(45%208.59265%200.928223)'%20fill='black'/%3e%3crect%20width='2.69743'%20height='11.4447'%20transform='matrix(0.707107%20-0.707107%20-0.707107%20-0.707107%208.59265%2017.1123)'%20fill='black'/%3e%3c/svg%3e",ft="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='11'%20height='18'%20viewBox='0%200%2011%2018'%20fill='none'%3e%3crect%20width='2.69743'%20height='11.4442'%20transform='matrix(-0.707107%200.707107%200.707107%200.707107%202.40735%200.928223)'%20fill='black'/%3e%3crect%20x='2.40735'%20y='17.1123'%20width='2.69743'%20height='11.4447'%20transform='rotate(-135%202.40735%2017.1123)'%20fill='black'/%3e%3c/svg%3e",H="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='21'%20height='21'%20viewBox='0%200%2021%2021'%20fill='none'%3e%3ccircle%20cx='10.5'%20cy='10.0203'%20r='9'%20fill='%234DC4CF'%20stroke='black'%20stroke-width='2'/%3e%3cline%20x1='6.44978'%20y1='5.07048'%20x2='15.6422'%20y2='14.2629'%20stroke='black'%20stroke-width='2'/%3e%3cline%20x1='5.7426'%20y1='14.2629'%20x2='14.935'%20y2='5.07048'%20stroke='black'%20stroke-width='2'/%3e%3c/svg%3e",pt={class:"modal"},vt={class:"modal-container"},ut={class:"modal-wrapper"},wt={class:"modal-info"},mt={class:"modal-info-top"},gt=["src"],xt={class:"modal-info-title-wrapper"},ht={class:"title-wrapper"},yt={class:"title-text"},_t={class:"type-wrapper"},bt={class:"type-text"},$t={class:"title-description"},Ct={class:"modal-info-bottom"},St={class:"details-title-wrapper"},Dt={class:"details-content-text"},Mt={class:"details-title-wrapper"},kt={class:"details-content-text"},Tt={class:"details-title-wrapper"},At={class:"details-content-text"},Ut={class:"details-title-wrapper"},Bt={class:"details-award-text"},It={class:"bottom-wrapper"},Gt={class:"question-wrapper"},Pt={class:"question-content-wrapper"},Nt={class:"answer-wrapper"},Vt={class:"answer-content-input"},Ft={__name:"ChallengeModal",props:{nft:{type:Object,required:!0}},emits:["closeModal"],setup(o,{emit:l}){R(),z();const{address:r,chainId:n,isConnected:p}=E(),w=o,m=l,g=h(""),y=h(""),$=async()=>{const i="https://ib9fm6yjjg.execute-api.ap-northeast-2.amazonaws.com/ctp/ctp/qa",e={token_id:w.nft.id.toString(),user:r.value,prompt_hash:w.nft.promptHash,question:g.value};try{const u=await(await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();console.log(u.message),y.value=u.message}catch(a){console.error("Error:",a)}},D=()=>{m("closeModal")},k=i=>{const e=new Date(i*1e3),a=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),d=e.getUTCHours(),s=String(e.getUTCMinutes()).padStart(2,"0"),c=d>=12?"PM":"AM",G=d%12||12;return`${a}.${u} ${G}:${s} ${c}`},B=(i,e)=>{const u=(e-i)/(60*60*24);return Math.round(u)},T=i=>(i/1e18).toFixed(2);return(i,e)=>(b(),M("div",pt,[t("div",vt,[e[11]||(e[11]=t("div",{class:"modal-title-text"},"Challenge",-1)),t("div",ut,[t("div",{class:"close-wrapper"},[t("img",{src:H,alt:"close",onClick:D})]),t("div",wt,[t("div",mt,[t("img",{src:o.nft.imageUri||"@/assets/nft/0.png",alt:"nft"},null,8,gt),t("div",xt,[e[2]||(e[2]=t("div",{class:"live-wrapper"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[t("circle",{cx:"6",cy:"6.02026",r:"5.5",fill:"#53926D"})]),t("div",{class:"live-text"},"Live")],-1)),t("div",ht,[t("div",yt,f(o.nft.name),1),t("div",_t,[t("div",bt,f(o.nft.gameType),1)]),t("div",$t,f(o.nft.description),1)])])]),t("div",Ct,[t("div",St,[e[3]||(e[3]=t("div",{class:"details-title-text"},"Start Date",-1)),t("div",Dt,f(k(o.nft.startDate)),1)]),t("div",Mt,[e[4]||(e[4]=t("div",{class:"details-title-text"},"End Date",-1)),t("div",kt,f(k(o.nft.endDate)),1)]),t("div",Tt,[e[5]||(e[5]=t("div",{class:"details-title-text"},"Remaining",-1)),t("div",At,f(B(o.nft.startDate,o.nft.endDate))+" days ",1)]),t("div",Ut,[e[6]||(e[6]=t("div",{class:"details-award-text"},"Awards",-1)),t("div",Bt,f(T(o.nft.awards))+" USDC ",1)])])]),t("div",It,[t("div",Gt,[e[8]||(e[8]=t("div",{class:"question-title-text"},"Question",-1)),t("div",Pt,[C(t("textarea",{class:"question-content-input",type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a)},null,512),[[S,g.value]]),t("div",{class:"submit-btn",onClick:e[1]||(e[1]=a=>$())},e[7]||(e[7]=[t("div",{class:"submit-text"},"Submit",-1)]))])]),t("div",Nt,[e[9]||(e[9]=t("div",{class:"answer-title-text"},"Answer",-1)),t("div",Vt,f(y.value),1)]),e[10]||(e[10]=Z('<div class="pk-wrapper" data-v-a81e77af><div class="pk-title-text" data-v-a81e77af>Secret</div><div class="pk-content-wrapper" data-v-a81e77af><input class="pk-content-input" data-v-a81e77af><div class="submit-btn" data-v-a81e77af><div class="submit-text" data-v-a81e77af>Submit</div></div></div></div>',1))])])])]))}},jt=F(Ft,[["__scopeId","data-v-a81e77af"]]);let _,U,x={Game:void 0,GameFrontend:void 0,Award:void 0,Badge:void 0};const O={gasPrice:"100000000001"};async function W(o){if(!_)try{_=new Q(o)}catch(l){console.log(l),_=new K(A.rpcUrl)}console.log(_),U=await _.getSigner(),x.Game||(x.Game=new I(A.contracts.Game,at.abi,_)),x.GameFrontend||(x.GameFrontend=new I(A.contracts.GameFrontend,nt.abi,_)),x.Award||(x.Award=new I(A.contracts.Award,it.abi,_)),x.Badge||(x.Badge=new I(A.contracts.Badge,ot.abi,_))}function qt(o){return new Promise(l=>setTimeout(l,o))}async function J(o){for(let r=0;r<10;r++){const n=await _.getTransactionReceipt(o);if(n)return n.status==1;await qt(1e3)}return!1}async function Et(o,l){await W(o);let r=await x.Award.connect(U).allowance(U.address,await x.Game.getAddress());if(console.log(r),r<l)try{let n=await x.Award.connect(U).approve(await x.Game.getAddress(),rt,{...O});return await J(n.hash),n}catch(n){console.error(n);return}}async function Lt(o,l,r,n){await W(o),console.log(l),console.log(r),console.log(n);try{let p=await x.Game.connect(U).mint(l,r,n,{...O});return await J(p.hash),p}catch(p){console.error(p);return}}const Ht={class:"modal"},Ot={class:"modal-container"},Wt={class:"modal-wrapper"},Jt={class:"content-wrapper"},Rt={class:"content-left-wrapper"},zt={class:"name-wrapper"},Zt={class:"description-wrapper"},Qt={class:"date-wrapper"},Kt={class:"date-input-wrapper"},Xt={class:"date-wrapper"},Yt={class:"date-input-wrapper"},te={class:"award-wrapper"},ee={class:"award-input-wrapper"},se={class:"content-right-wrapper"},ae={class:"type-wrapper"},ne={class:"type-content-secret-wrapper"},ie={class:"description-wrapper"},oe={class:"name-wrapper"},le={__name:"CreateModal",emits:["closeCreateModal"],setup(o,{emit:l}){const r=l,n=h({name:"",description:"",award:"",gameType:"secret",prompt:"",secret:"",start:0,end:0,winner:L}),p=h(""),w=h(""),m=h(""),g=h(""),y=h(""),$=h(0),{walletProvider:D}=X(),{address:k,chainId:B,isConnected:T}=E(),i=()=>{r("closeCreateModal")},e=d=>{$.value=d},a=()=>{if(p.value===""||w.value==""||m.value==""||g.value==""||y.value==""||!T.value||!w.value.includes(m.value))return!1;const d=new Date(g.value).getTime()/1e3,s=new Date(y.value).getTime()/1e3;return!(d>=s)},u=async()=>{if(a()){n.value.start=new Date(g.value).getTime()/1e3,n.value.end=new Date(y.value).getTime()/1e3,n.value.prompt=P(j(w.value)),n.value.secret=P(P(j(m.value)));const d=Y(p.value.toString(),18);await dt(n.value.prompt,w.value,n.value.secret,m.value),await Et(D.value,d),await Lt(D.value,k.value,n.value,d)}};return(d,s)=>(b(),M("div",Ht,[t("div",Ot,[s[23]||(s[23]=t("div",{class:"title-text"},"Get started with a CTP",-1)),t("div",Wt,[t("div",{class:"close-wrapper"},[t("img",{src:H,alt:"close",onClick:i})]),s[22]||(s[22]=t("div",{class:"about-wrapper"},[t("div",{class:"about-text"},"Create A New Challenge")],-1)),t("div",Jt,[t("div",Rt,[t("div",zt,[s[8]||(s[8]=t("div",{class:"name-text"},"Name",-1)),C(t("input",{class:"name-input","onUpdate:modelValue":s[0]||(s[0]=c=>n.value.name=c),placeholder:"Name",type:"text"},null,512),[[S,n.value.name]])]),t("div",Zt,[s[9]||(s[9]=t("div",{class:"description-text"},"Description",-1)),C(t("textarea",{class:"description-input","onUpdate:modelValue":s[1]||(s[1]=c=>n.value.description=c),placeholder:"Description"},null,512),[[S,n.value.description]])]),t("div",Qt,[s[10]||(s[10]=t("div",{class:"date-text"},"Start Date",-1)),t("div",Kt,[C(t("input",{class:"date-input","onUpdate:modelValue":s[2]||(s[2]=c=>g.value=c),type:"datetime-local"},null,512),[[S,g.value]])])]),t("div",Xt,[s[11]||(s[11]=t("div",{class:"date-text"},"End Date",-1)),t("div",Yt,[C(t("input",{class:"date-input","onUpdate:modelValue":s[3]||(s[3]=c=>y.value=c),type:"datetime-local"},null,512),[[S,y.value]])])]),t("div",te,[s[13]||(s[13]=t("div",{class:"award-text"},"Award",-1)),t("div",ee,[C(t("input",{class:"award-input","onUpdate:modelValue":s[4]||(s[4]=c=>p.value=c),type:"number"},null,512),[[S,p.value]]),s[12]||(s[12]=t("div",{class:"usdc-wrapper"},[t("div",{class:"usdc-text"},"USDC")],-1))])])]),t("div",se,[t("div",ae,[s[17]||(s[17]=t("div",{class:"type-text"},"Type",-1)),t("div",ne,[t("div",{class:v(["type-content-wrapper",{"is-type-active":$.value==0}]),onClick:s[5]||(s[5]=c=>e(0))},s[14]||(s[14]=[t("div",{class:"type-content-text"},"Secret",-1)]),2),t("div",{class:v(["type-content-wrapper",{"is-type-active":$.value==1}])},s[15]||(s[15]=[t("div",{class:"type-content-text"},"Slang",-1)]),2),t("div",{class:v(["type-content-wrapper",{"is-type-active":$.value==2}])},s[16]||(s[16]=[t("div",{class:"type-content-text"},"Mismatch",-1)]),2)])]),t("div",ie,[s[18]||(s[18]=t("div",{class:"description-text"},"Prompt",-1)),C(t("textarea",{class:"prompt-input","onUpdate:modelValue":s[6]||(s[6]=c=>w.value=c),placeholder:"Prompt"},null,512),[[S,w.value]])]),t("div",oe,[s[19]||(s[19]=t("div",{class:"name-text"},"Secret",-1)),C(t("input",{class:"name-input","onUpdate:modelValue":s[7]||(s[7]=c=>m.value=c),placeholder:"Secret",type:"text"},null,512),[[S,m.value]])]),t("div",{class:"submit-wrapper"},[s[21]||(s[21]=t("div",{class:"empty-text"},null,-1)),t("div",{class:"submit-btn-wrapper",onClick:u},s[20]||(s[20]=[t("div",{class:"submit-btn-text"},"Submit",-1)]))])])])])])]))}},re=F(le,[["__scopeId","data-v-99ad3ca0"]]),de={key:0,class:"challenge"},ce={class:"challenge-wrapper"},fe={class:"challenge-live-filter"},pe={class:"challenge-type-filter-wrapper"},ve={class:"challenge-type-filter"},ue={class:"nfts"},we={class:"nft-content-wrapper"},me={class:"nft-content-top-wrapper"},ge=["src"],xe={class:"nft-content-top-title-wrapper"},he={class:"live-wrapper"},ye={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},_e=["fill"],be={class:"live-text"},$e={class:"live-title-wrapper"},Ce={class:"live-title-text"},Se={class:"type-wrapper"},De={class:"type-text"},Me={class:"nft-description"},ke={class:"nft-date-wrapper"},Te={class:"nft-date-content-wrapper"},Ae={class:"nft-date-content-text"},Ue={class:"nft-date-content-text"},Be={class:"nft-duration-wrapper"},Ie={class:"nft-duration-content-text"},Ge={class:"nft-award-wrapper"},Pe={class:"nft-award-content-text"},Ne=["onClick"],Ve={class:"nft-btn-text"},Fe={class:"pagination"},je={class:"pagination-wrapper"},qe={class:"number-wrapper"},Ee={__name:"ChallengePage",setup(o){const l=h(!1),r=h(!1),n=h(null),p=h([]),w=i=>{n.value=i,l.value=!0},m=()=>{l.value=!1},g=()=>{r.value=!0},y=()=>{r.value=!1},$=async()=>{const i=await lt(0,12);p.value=i.map(e=>{const a=e[11],u=Math.floor(Date.now()/1e3);console.log(a);let d="Live";return a.toLowerCase()==="0xffffffffffffffffffffffffffffffffffffffff"?d="Verified":a!==L?d="Solved":u>Number(e[9])&&(d="End"),{status:d,winnerAddress:a,id:e[0],tokenId:e[1],name:e[2],description:e[3],gameType:e[4],promptHash:e[5],secretHash:e[6],imageUri:e[7],startDate:Number(e[8]),endDate:Number(e[9]),awards:Number(e[10])}}).reverse(),console.log(p.value)},D=i=>{const e=new Date(i*1e3),a=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),d=e.getUTCHours(),s=String(e.getUTCMinutes()).padStart(2,"0"),c=d>=12?"PM":"AM",G=d%12||12;return`${a}.${u} ${G}:${s} ${c}`},k=(i,e)=>{const u=(e-i)/(60*60*24);return Math.round(u)},B=i=>st(i.toString(),18),T=i=>i&&`Winner: ${i.slice(0,6)}...${i.slice(-4)}`;return tt(()=>{$()}),(i,e)=>(b(),M(q,null,[!l.value&&!r.value?(b(),M("div",de,[t("div",ce,[e[9]||(e[9]=t("div",{class:"challenge-title-text"},"Challenges",-1)),t("div",fe,[t("div",{class:v(["challenge-live-filter-btn",{"is-live-active":!0}])}," All "),t("div",{class:v(["challenge-live-filter-btn",{"is-live-active":!1}])}," Live "),t("div",{class:v(["challenge-live-filter-btn",{"is-live-active":!1}])}," End ")]),t("div",pe,[t("div",ve,[t("div",{class:v(["challenge-type-filter-btn",{"is-type-active":!0}])},[t("div",{class:v(["challenge-type-filter-btn-text",{"is-type-text-active":!0}])}," All Type ")]),t("div",{class:v(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:v(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Secret ")]),t("div",{class:v(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:v(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Slang ")]),t("div",{class:v(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:v(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Mismatch ")])]),t("div",{class:"challenge-create-new-btn",onClick:g}," + Create A New Challange ")]),t("div",ue,[(b(!0),M(q,null,et(p.value,(a,u)=>(b(),M("div",{key:a.id,class:"nft-wrapper"},[t("div",we,[t("div",me,[t("img",{src:a.imageUri?a.imageUri:"@/assets/nft/0.png",alt:"nft"},null,8,ge),t("div",xe,[t("div",he,[(b(),M("svg",ye,[t("circle",{cx:"6",cy:"6.02026",r:"5.5",fill:a.status==="Live"?"#53926D":"#CC0000"},null,8,_e)])),t("div",be,f(a.status==="Live"?"Live":"End"),1)]),t("div",$e,[t("div",Ce,f(a.name),1),t("div",Se,[t("div",De,f(a.gameType),1)])])])]),t("div",Me,f(a.description),1),t("div",ke,[e[0]||(e[0]=t("div",{class:"nft-date-text"},"Date",-1)),t("div",Te,[t("div",Ae,f(D(a.startDate)),1),t("div",Ue," ~ "+f(D(a.endDate)),1)])]),t("div",Be,[e[1]||(e[1]=t("div",{class:"nft-duration-text"},"Remaining",-1)),t("div",Ie,f(k(a.startDate,a.endDate))+" days ",1)]),t("div",Ge,[e[2]||(e[2]=t("div",{class:"nft-award-text"},"Award",-1)),t("div",Pe,f(B(a.awards))+" USDC ",1)])]),t("div",{class:v(["nft-btn",{disabled:a.status==="Solved"}]),onClick:d=>a.status!=="Solved"&&w(a)},[t("div",Ve,f(a.status==="Solved"?T(a.winnerAddress):a.status==="Verified"?"Verified":"Challenge"),1)],10,Ne)]))),128))]),t("div",Fe,[t("div",je,[e[7]||(e[7]=t("img",{src:ct,alt:"left"},null,-1)),t("div",qe,[t("div",{class:v(["number-text",{"is-pagination-active":!0}])}," 1 "),e[3]||(e[3]=t("div",{class:"number-text"},"2",-1)),e[4]||(e[4]=t("div",{class:"number-text"},"3",-1)),e[5]||(e[5]=t("div",{class:"number-text"},"4",-1)),e[6]||(e[6]=t("div",{class:"number-text"},"5",-1))]),e[8]||(e[8]=t("img",{src:ft,alt:"right"},null,-1))])])])])):N("",!0),l.value?(b(),V(jt,{key:1,nft:n.value,onCloseModal:m},null,8,["nft"])):N("",!0),r.value?(b(),V(re,{key:2,onCloseCreateModal:y})):N("",!0)],64))}},Le=F(Ee,[["__scopeId","data-v-97f114a4"]]),We={__name:"ChallengeView",setup(o){return(l,r)=>(b(),V(Le))}};export{We as default};
