import{_ as j,u as R,a as z,b as E,r as h,o as y,c as k,d as t,t as p,w as C,v as S,e as Z,B as Q,J as K,f as A,C as V,Z as P,g as X,n as c,k as N,h as q,p as Y,i as tt,F as L,j as et,l as U,m as F,q as st}from"./index-BOIZEeFm.js";import{G as at,a as nt,U as it,B as lt,g as ot}from"./gameView-CVKIFXVd.js";BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");BigInt("1000000000000000000");const rt=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");BigInt("0x8000000000000000000000000000000000000000000000000000000000000000")*BigInt(-1);BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");async function dt(l,o,r,n){const v="https://ib9fm6yjjg.execute-api.ap-northeast-2.amazonaws.com/ctp/ctp/create-prompt",w={prompt_hash:l,prompt:o,secret_hash:r,secret:n};try{const g=await(await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();console.log(g.message)}catch(m){console.error("Error:",m)}}const ct="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='11'%20height='18'%20viewBox='0%200%2011%2018'%20fill='none'%3e%3crect%20x='8.59265'%20y='0.928223'%20width='2.69743'%20height='11.4442'%20transform='rotate(45%208.59265%200.928223)'%20fill='black'/%3e%3crect%20width='2.69743'%20height='11.4447'%20transform='matrix(0.707107%20-0.707107%20-0.707107%20-0.707107%208.59265%2017.1123)'%20fill='black'/%3e%3c/svg%3e",ft="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='11'%20height='18'%20viewBox='0%200%2011%2018'%20fill='none'%3e%3crect%20width='2.69743'%20height='11.4442'%20transform='matrix(-0.707107%200.707107%200.707107%200.707107%202.40735%200.928223)'%20fill='black'/%3e%3crect%20x='2.40735'%20y='17.1123'%20width='2.69743'%20height='11.4447'%20transform='rotate(-135%202.40735%2017.1123)'%20fill='black'/%3e%3c/svg%3e",H="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='21'%20height='21'%20viewBox='0%200%2021%2021'%20fill='none'%3e%3ccircle%20cx='10.5'%20cy='10.0203'%20r='9'%20fill='%234DC4CF'%20stroke='black'%20stroke-width='2'/%3e%3cline%20x1='6.44978'%20y1='5.07048'%20x2='15.6422'%20y2='14.2629'%20stroke='black'%20stroke-width='2'/%3e%3cline%20x1='5.7426'%20y1='14.2629'%20x2='14.935'%20y2='5.07048'%20stroke='black'%20stroke-width='2'/%3e%3c/svg%3e",pt={class:"modal"},vt={class:"modal-container"},ut={class:"modal-wrapper"},wt={class:"modal-info"},mt={class:"modal-info-top"},gt=["src"],xt={class:"modal-info-title-wrapper"},ht={class:"title-wrapper"},yt={class:"title-text"},_t={class:"type-wrapper"},bt={class:"type-text"},$t={class:"title-description"},Ct={class:"modal-info-bottom"},St={class:"details-title-wrapper"},kt={class:"details-content-text"},Dt={class:"details-title-wrapper"},Mt={class:"details-content-text"},Tt={class:"details-title-wrapper"},At={class:"details-content-text"},Ut={class:"details-title-wrapper"},Bt={class:"details-award-text"},It={class:"bottom-wrapper"},Vt={class:"question-wrapper"},Gt={class:"question-content-wrapper"},Nt={class:"answer-wrapper"},Pt={class:"answer-content-input"},Ft={__name:"ChallengeModal",props:{nft:{type:Object,required:!0}},emits:["closeModal"],setup(l,{emit:o}){R(),z();const{address:r,chainId:n,isConnected:v}=E(),w=l,m=o,g=h(""),_=h(""),$=async()=>{const i="https://ib9fm6yjjg.execute-api.ap-northeast-2.amazonaws.com/ctp/ctp/qa",e={token_id:w.nft.id.toString(),user:r.value,prompt_hash:w.nft.promptHash,question:g.value};try{const u=await(await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();console.log(u.message),_.value=u.message}catch(a){console.error("Error:",a)}},D=()=>{m("closeModal")},M=i=>{const e=new Date(i*1e3),a=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),d=e.getUTCHours(),s=String(e.getUTCMinutes()).padStart(2,"0"),f=d>=12?"PM":"AM",G=d%12||12;return`${a}.${u} ${G}:${s} ${f}`},I=(i,e)=>{const u=(e-i)/(60*60*24);return Math.round(u)},T=i=>(i/1e18).toFixed(2);return(i,e)=>(y(),k("div",pt,[t("div",vt,[e[11]||(e[11]=t("div",{class:"modal-title-text"},"Challenge",-1)),t("div",ut,[t("div",{class:"close-wrapper"},[t("img",{src:H,alt:"close",onClick:D})]),t("div",wt,[t("div",mt,[t("img",{src:l.nft.imageUri||"@/assets/nft/0.png",alt:"nft"},null,8,gt),t("div",xt,[e[2]||(e[2]=t("div",{class:"live-wrapper"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[t("circle",{cx:"6",cy:"6.02026",r:"5.5",fill:"#53926D"})]),t("div",{class:"live-text"},"Live")],-1)),t("div",ht,[t("div",yt,p(l.nft.name),1),t("div",_t,[t("div",bt,p(l.nft.gameType),1)]),t("div",$t,p(l.nft.description),1)])])]),t("div",Ct,[t("div",St,[e[3]||(e[3]=t("div",{class:"details-title-text"},"Start Date",-1)),t("div",kt,p(M(l.nft.startDate)),1)]),t("div",Dt,[e[4]||(e[4]=t("div",{class:"details-title-text"},"End Date",-1)),t("div",Mt,p(M(l.nft.endDate)),1)]),t("div",Tt,[e[5]||(e[5]=t("div",{class:"details-title-text"},"Remaining",-1)),t("div",At,p(I(l.nft.startDate,l.nft.endDate))+" days ",1)]),t("div",Ut,[e[6]||(e[6]=t("div",{class:"details-award-text"},"Awards",-1)),t("div",Bt,p(T(l.nft.awards))+" USDC ",1)])])]),t("div",It,[t("div",Vt,[e[8]||(e[8]=t("div",{class:"question-title-text"},"Question",-1)),t("div",Gt,[C(t("textarea",{class:"question-content-input",type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a)},null,512),[[S,g.value]]),t("div",{class:"submit-btn",onClick:e[1]||(e[1]=a=>$())},e[7]||(e[7]=[t("div",{class:"submit-text"},"Submit",-1)]))])]),t("div",Nt,[e[9]||(e[9]=t("div",{class:"answer-title-text"},"Answer",-1)),t("div",Pt,p(_.value),1)]),e[10]||(e[10]=Z('<div class="pk-wrapper" data-v-a81e77af><div class="pk-title-text" data-v-a81e77af>Secret</div><div class="pk-content-wrapper" data-v-a81e77af><input class="pk-content-input" data-v-a81e77af><div class="submit-btn" data-v-a81e77af><div class="submit-text" data-v-a81e77af>Submit</div></div></div></div>',1))])])])]))}},jt=j(Ft,[["__scopeId","data-v-a81e77af"]]);let b,B,x={Game:void 0,GameFrontend:void 0,Award:void 0,Badge:void 0};const O={gasPrice:"100000000001"};async function W(l){if(!b)try{b=new Q(l)}catch(o){console.log(o),b=new K(A.rpcUrl)}console.log(b),B=await b.getSigner(),x.Game||(x.Game=new V(A.contracts.Game,at.abi,b)),x.GameFrontend||(x.GameFrontend=new V(A.contracts.GameFrontend,nt.abi,b)),x.Award||(x.Award=new V(A.contracts.Award,it.abi,b)),x.Badge||(x.Badge=new V(A.contracts.Badge,lt.abi,b))}function qt(l){return new Promise(o=>setTimeout(o,l))}async function J(l){for(let r=0;r<10;r++){const n=await b.getTransactionReceipt(l);if(n)return n.status==1;await qt(1e3)}return!1}async function Lt(l,o){await W(l);let r=await x.Award.connect(B).allowance(B.address,await x.Game.getAddress());if(console.log(r),r<o)try{let n=await x.Award.connect(B).approve(await x.Game.getAddress(),rt,{...O});return await J(n.hash),n}catch(n){console.error(n);return}}async function Et(l,o,r,n){await W(l),console.log(o),console.log(r),console.log(n);try{let v=await x.Game.connect(B).mint(o,r,n,{...O});return await J(v.hash),v}catch(v){console.error(v);return}}const Ht={class:"modal"},Ot={class:"modal-container"},Wt={class:"modal-wrapper"},Jt={class:"content-wrapper"},Rt={class:"content-left-wrapper"},zt={class:"name-wrapper"},Zt={class:"description-wrapper"},Qt={class:"date-wrapper"},Kt={class:"date-input-wrapper"},Xt={class:"date-wrapper"},Yt={class:"date-input-wrapper"},te={class:"award-wrapper"},ee={class:"award-input-wrapper"},se={class:"content-right-wrapper"},ae={class:"type-wrapper"},ne={class:"type-content-secret-wrapper"},ie={class:"description-wrapper"},le={class:"name-wrapper"},oe={__name:"CreateModal",emits:["closeCreateModal"],setup(l,{emit:o}){const r=o,n=h({name:"",description:"",award:"",gameType:"secret",prompt:"",secret:"",start:0,end:0,winner:P}),v=h(""),w=h(""),m=h(""),g=h(""),_=h(""),$=h(0),{walletProvider:D}=X(),{address:M,chainId:I,isConnected:T}=E(),i=()=>{r("closeCreateModal")},e=d=>{$.value=d},a=()=>{if(v.value===""||w.value==""||m.value==""||g.value==""||_.value==""||!T.value||!w.value.includes(m.value))return!1;const d=new Date(g.value).getTime()/1e3,s=new Date(_.value).getTime()/1e3;return!(d>=s)},u=async()=>{if(a()){n.value.start=new Date(g.value).getTime()/1e3,n.value.end=new Date(_.value).getTime()/1e3,n.value.prompt=N(q(w.value)),n.value.secret=N(N(q(m.value)));const d=Y(v.value.toString(),18);await dt(n.value.prompt,w.value,n.value.secret,m.value),await Lt(D.value,d),await Et(D.value,M.value,n.value,d)}};return(d,s)=>(y(),k("div",Ht,[t("div",Ot,[s[23]||(s[23]=t("div",{class:"title-text"},"Get started with a CTP",-1)),t("div",Wt,[t("div",{class:"close-wrapper"},[t("img",{src:H,alt:"close",onClick:i})]),s[22]||(s[22]=t("div",{class:"about-wrapper"},[t("div",{class:"about-text"},"Create A New Challenge")],-1)),t("div",Jt,[t("div",Rt,[t("div",zt,[s[8]||(s[8]=t("div",{class:"name-text"},"Name",-1)),C(t("input",{class:"name-input","onUpdate:modelValue":s[0]||(s[0]=f=>n.value.name=f),placeholder:"Name",type:"text"},null,512),[[S,n.value.name]])]),t("div",Zt,[s[9]||(s[9]=t("div",{class:"description-text"},"Description",-1)),C(t("textarea",{class:"description-input","onUpdate:modelValue":s[1]||(s[1]=f=>n.value.description=f),placeholder:"Description"},null,512),[[S,n.value.description]])]),t("div",Qt,[s[10]||(s[10]=t("div",{class:"date-text"},"Start Date",-1)),t("div",Kt,[C(t("input",{class:"date-input","onUpdate:modelValue":s[2]||(s[2]=f=>g.value=f),type:"datetime-local"},null,512),[[S,g.value]])])]),t("div",Xt,[s[11]||(s[11]=t("div",{class:"date-text"},"End Date",-1)),t("div",Yt,[C(t("input",{class:"date-input","onUpdate:modelValue":s[3]||(s[3]=f=>_.value=f),type:"datetime-local"},null,512),[[S,_.value]])])]),t("div",te,[s[13]||(s[13]=t("div",{class:"award-text"},"Award",-1)),t("div",ee,[C(t("input",{class:"award-input","onUpdate:modelValue":s[4]||(s[4]=f=>v.value=f),type:"number"},null,512),[[S,v.value]]),s[12]||(s[12]=t("div",{class:"usdc-wrapper"},[t("div",{class:"usdc-text"},"USDC")],-1))])])]),t("div",se,[t("div",ae,[s[17]||(s[17]=t("div",{class:"type-text"},"Type",-1)),t("div",ne,[t("div",{class:c(["type-content-wrapper",{"is-type-active":$.value==0}]),onClick:s[5]||(s[5]=f=>e(0))},s[14]||(s[14]=[t("div",{class:"type-content-text"},"Secret",-1)]),2),t("div",{class:c(["type-content-wrapper",{"is-type-active":$.value==1}])},s[15]||(s[15]=[t("div",{class:"type-content-text"},"Slang",-1)]),2),t("div",{class:c(["type-content-wrapper",{"is-type-active":$.value==2}])},s[16]||(s[16]=[t("div",{class:"type-content-text"},"Mismatch",-1)]),2)])]),t("div",ie,[s[18]||(s[18]=t("div",{class:"description-text"},"Prompt",-1)),C(t("textarea",{class:"prompt-input","onUpdate:modelValue":s[6]||(s[6]=f=>w.value=f),placeholder:"Prompt"},null,512),[[S,w.value]])]),t("div",le,[s[19]||(s[19]=t("div",{class:"name-text"},"Secret",-1)),C(t("input",{class:"name-input","onUpdate:modelValue":s[7]||(s[7]=f=>m.value=f),placeholder:"Secret",type:"text"},null,512),[[S,m.value]])]),t("div",{class:"submit-wrapper"},[s[21]||(s[21]=t("div",{class:"empty-text"},null,-1)),t("div",{class:"submit-btn-wrapper",onClick:u},s[20]||(s[20]=[t("div",{class:"submit-btn-text"},"Submit",-1)]))])])])])])]))}},re=j(oe,[["__scopeId","data-v-99ad3ca0"]]),de={key:0,class:"challenge"},ce={class:"challenge-wrapper"},fe={class:"challenge-live-filter"},pe={class:"challenge-type-filter-wrapper"},ve={class:"challenge-type-filter"},ue={class:"nfts"},we={class:"nft-content-wrapper"},me={class:"nft-content-top-wrapper"},ge=["src"],xe={class:"nft-content-top-title-wrapper"},he={class:"live-wrapper"},ye={key:0,xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},_e=["fill"],be={key:1,xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",viewBox:"0 0 19 19",fill:"none"},$e={class:"live-text"},Ce={class:"live-title-wrapper"},Se={class:"live-title-text"},ke={class:"type-wrapper"},De={class:"type-text"},Me={class:"nft-description"},Te={class:"nft-date-wrapper"},Ae={class:"nft-date-content-wrapper"},Ue={class:"nft-date-content-text"},Be={class:"nft-date-content-text"},Ie={class:"nft-duration-wrapper"},Ve={class:"nft-duration-content-text"},Ge={class:"nft-award-wrapper"},Ne=["onClick"],Pe={class:"nft-btn-text"},Fe={class:"pagination"},je={class:"pagination-wrapper"},qe={class:"number-wrapper"},Le={__name:"ChallengePage",setup(l){const o=h(!1),r=h(!1),n=h(null),v=h([]),w=i=>{i.status==="Live"&&(n.value=i,o.value=!0)},m=()=>{o.value=!1},g=()=>{r.value=!0},_=()=>{r.value=!1},$=async()=>{const i=await ot(0,12);v.value=i.map(e=>{const a=e[11],u=Math.floor(Date.now()/1e3);console.log(a);let d="Live";return a.toLowerCase()==="0xffffffffffffffffffffffffffffffffffffffff"||a===P&&u>Number(e[9])?d="Verified":a!==P?d="Solved":u>Number(e[9])&&(d="End"),{status:d,winnerAddress:a,id:e[0],tokenId:e[1],name:e[2],description:e[3],gameType:e[4],promptHash:e[5],secretHash:e[6],imageUri:e[7],startDate:Number(e[8]),endDate:Number(e[9]),awards:Number(e[10])}}).reverse(),console.log(v.value)},D=i=>{const e=new Date(i*1e3),a=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),d=e.getUTCHours(),s=String(e.getUTCMinutes()).padStart(2,"0"),f=d>=12?"PM":"AM",G=d%12||12;return`${a}.${u} ${G}:${s} ${f}`},M=(i,e)=>{const u=(e-i)/(60*60*24);return Math.round(u)},I=i=>st(i.toString(),18),T=i=>i&&`Winner: ${i.slice(0,6)}...${i.slice(-4)}`;return tt(()=>{$()}),(i,e)=>(y(),k(L,null,[!o.value&&!r.value?(y(),k("div",de,[t("div",ce,[e[9]||(e[9]=t("div",{class:"challenge-title-text"},"Challenges",-1)),t("div",fe,[t("div",{class:c(["challenge-live-filter-btn",{"is-live-active":!0}])}," All "),t("div",{class:c(["challenge-live-filter-btn",{"is-live-active":!1}])}," Live "),t("div",{class:c(["challenge-live-filter-btn",{"is-live-active":!1}])}," End ")]),t("div",pe,[t("div",ve,[t("div",{class:c(["challenge-type-filter-btn",{"is-type-active":!0}])},[t("div",{class:c(["challenge-type-filter-btn-text",{"is-type-text-active":!0}])}," All Type ")]),t("div",{class:c(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:c(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Secret ")]),t("div",{class:c(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:c(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Slang ")]),t("div",{class:c(["challenge-type-filter-btn",{"is-type-active":!1}])},[t("div",{class:c(["challenge-type-filter-btn-text",{"is-type-text-active":!1}])}," Mismatch ")])]),t("div",{class:"challenge-create-new-btn",onClick:g}," + Create A New Challange ")]),t("div",ue,[(y(!0),k(L,null,et(v.value,(a,u)=>(y(),k("div",{key:a.id,class:c(["nft-wrapper",{"is-verified-nft":a.status==="Verified"}])},[t("div",we,[t("div",me,[t("img",{src:a.imageUri?a.imageUri:"@/assets/nft/0.png",alt:"nft"},null,8,ge),t("div",xe,[t("div",he,[a.status!=="Verified"?(y(),k("svg",ye,[t("circle",{cx:"6",cy:"6.02026",r:"5.5",fill:a.status==="Live"?"#53926D":"#CC0000"},null,8,_e)])):U("",!0),a.status==="Verified"?(y(),k("svg",be,e[0]||(e[0]=[t("circle",{cx:"9.5",cy:"9.5",r:"8",fill:"#4DC4CF",stroke:"black","stroke-width":"2"},null,-1),t("rect",{x:"3.5",y:"7.91431",width:"2",height:"8.48528",transform:"rotate(-45 3.5 7.91431)",fill:"black"},null,-1),t("rect",{width:"2",height:"8.48563",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 15.5 7.91431)",fill:"black"},null,-1)]))):U("",!0),t("div",$e,p(a.status),1)]),t("div",Ce,[t("div",Se,p(a.name),1),t("div",ke,[t("div",De,p(a.gameType),1)])])])]),t("div",Me,p(a.description),1),t("div",Te,[e[1]||(e[1]=t("div",{class:"nft-date-text"},"Date",-1)),t("div",Ae,[t("div",Ue,p(D(a.startDate)),1),t("div",Be," ~ "+p(D(a.endDate)),1)])]),t("div",Ie,[e[2]||(e[2]=t("div",{class:"nft-duration-text"},"Remaining",-1)),t("div",Ve,p(M(a.startDate,a.endDate))+" days ",1)]),t("div",Ge,[t("div",{class:c(["nft-award-text",{"is-verified-nft-text":a.status==="Verified"}])}," Award ",2),t("div",{class:c(["nft-award-content-text",{"is-verified-nft-text":a.status==="Verified"}])},p(I(a.awards))+" USDC ",3)])]),t("div",{class:c(["nft-btn",{"is-live":a.status==="Live"}]),onClick:d=>a.status!=="Solved"&&w(a)},[t("div",Pe,p(a.status==="Solved"?T(a.winnerAddress):a.status==="Verified"?"Verified":"Challenge"),1)],10,Ne)],2))),128))]),t("div",Fe,[t("div",je,[e[7]||(e[7]=t("img",{src:ct,alt:"left"},null,-1)),t("div",qe,[t("div",{class:c(["number-text",{"is-pagination-active":!0}])}," 1 "),e[3]||(e[3]=t("div",{class:"number-text"},"2",-1)),e[4]||(e[4]=t("div",{class:"number-text"},"3",-1)),e[5]||(e[5]=t("div",{class:"number-text"},"4",-1)),e[6]||(e[6]=t("div",{class:"number-text"},"5",-1))]),e[8]||(e[8]=t("img",{src:ft,alt:"right"},null,-1))])])])])):U("",!0),o.value?(y(),F(jt,{key:1,nft:n.value,onCloseModal:m},null,8,["nft"])):U("",!0),r.value?(y(),F(re,{key:2,onCloseCreateModal:_})):U("",!0)],64))}},Ee=j(Le,[["__scopeId","data-v-bdabb975"]]),We={__name:"ChallengeView",setup(l){return(o,r)=>(y(),F(Ee))}};export{We as default};
